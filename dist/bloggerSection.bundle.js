/*!
* blogger.section 0.1.0
* https://github.com/Karasu-themes/bloggerSection
*
* Copyright Â© 2022 MarceloTLD
* 
* Released under the MIT License
*-----------------------------------------------*/
(function(g,h){typeof exports=="object"&&typeof module<"u"?module.exports=h():typeof define=="function"&&define.amd?define(h):(g=typeof globalThis<"u"?globalThis:g||self,g.BloggerSection=h())})(this,function(){"use strict";function g(e,o,n,l){let c=document.createElement("script"),a=`${e}/feeds/posts/${o?"default/-/"+o:"default"}?alt=json-in-script&max-results=${l}&callback=${n}`;return c.src=a,c}function h(e,o,n,l){return new Promise(c=>{const a=g(e,o,n,l);document.body.appendChild(a),window[n]=r=>{c(r.feed.entry||!1)},a.remove()})}function w(e,o){const n=(c,a)=>{e(c,a)};return new IntersectionObserver(n,o||{threshold:.3,rootMargin:"200px"})}function A(e,o){const n=e.content?e.content.$t:e.summary.$t;function l(t){return t.match(/post-\d{1,}/g)[0].replace("post-","")}function c(t){let s=t,u="";for(var f=0;f<s.length;f++)s[f].rel=="alternate"&&(u=s[f].href);return u}function a(t){return t.replace(/<[^>]*>?/g,"")}function i(t){const s=a(t);return s.length>o.summary?s.substr(0,o.summary)+"...":s}function r(t){let s=document.createElement("div");s.innerHTML=t;let u=s.querySelector("img");return u?u.src:o.dftImage||"#noImageFounded"}function m(t){const s=t.match(/data-[\w-]+="[^"]+"/g);if(s.length>0){const u={};return s.forEach(f=>{const p=f.match(/\".+\"/)[0].replace(/\"/g,""),d=f.match(/data-.+=/g)[0].replace(/data-|=/g,"").replace(/-\w+/g,function(E){const y=E.replace("-","");return y[0].toUpperCase()+y.slice(1)});u[d]=p}),u}else return{}}return{id:l(e.id.$t),title:e.title.$t,thumbnail:e.media$thumbnail?e.media$thumbnail.url.replace(/s\B\d{2,4}(-?w\d{2,4})?-c/,o.imageParams):r(n),image:e.media$thumbnail?e.media$thumbnail.url:r(n),label:e.category?e.category.map(t=>t.term):"",link:c(e.link),url:c(e.link),content:n,summary:i(n),datePost:new Date(e.published.$t).toLocaleDateString(),postUpdate:new Date(e.updated.$t).toLocaleDateString(),datePostIso8601:e.published.$t,authorName:e.name?e.name.$t:"Unknown",authorUri:e.uri?e.uri.$t:"#noProfileUrl",currentId:o.currentId===l(e.id.$t),...m(n)}}function P(e,o){function n(i){return i.trim().replace(/{if(\.\w+\s)[^]*?\/}/g,r=>{if(/{if(\.\w+\s)[^]*?\/}/g.test(r)){const m=r.replace(/{if(\.\w+\s)|\/\}/g,""),t=r.match(/if\.\w+/g)[0].replace("if.","");return e[t]?m:""}return r})}function l(i,r){if(!Array.isArray(r))return i;const m=/{for(\.\w+)\s+(.+)\s+\/for}/g;let t="";if(m.test(i)){const s=i.match(m)[0].replace(/{for(\.\w+)|\/for}/g,"").trim();r.forEach(u=>{t+=s.replace(/labelName/g,u)})}return i.replace(m,t).trim()}const c=n(o);return l(c,e.label).replace(/\{(.*?)\}/g,i=>{let r=i.replace(/{|}/g,"");if(/\{image.+\}/.test(i)){const t=i.replace(/{image.|}/g,"");return e.image.replace(/s\B\d{2,4}(-?w\d{2,4})?-c/,t)??""}else return e[r]??""})}function T(e,o){var n;for(n in o)o.hasOwnProperty(n)&&(e[n]=o[n]);return e}function I(e,o){const n=document.querySelectorAll(".bs-wrapper");if(n.length==0){console.warn("Warning: The node elements is not founded, please check if the node element passing as parameter exist en your HTML document");return}let l=w((c,a)=>{c.forEach(i=>{let r=i.target,m=r.querySelector(".bs-loader");const t=r.querySelector(".bs-container");if(!t)return;const s=t.querySelector(".bs-render"),u=s.innerHTML.replace(/data-/g,""),f={imageParams:"s300-c-e60-l95",summary:54,results:6,empty:"No hay entradas que mostrar"};if(i.isIntersecting){const p={...e,...o??{}},d=T({...f,...p},r.dataset??{}),E=window.location.protocol+"//"+window.location.hostname;h(d.homeUrl||E,d.label,"bsFn"+(r.index+1),d.results).then(y=>{let b="";y?y.forEach(R=>{b+=P(A(R,T(f,p)),u)}):b+=`<p class="bs-empty">${d.empty||f.empty}</p>`,t.innerHTML=b,p.modes&&p.modes[d.mode]&&typeof p.modes[d.mode]=="function"&&p.modes[d.mode].call(this,r,t,{...p,...d})}).finally(function(){m&&m.remove()}),l.unobserve(r)}})});n.forEach((c,a)=>{c.index=a,l.observe(c)})}var L={start:I};return L});
