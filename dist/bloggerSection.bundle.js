/*!
* blogger.section 0.1.0
* https://github.com/Karasu-themes/bloggerSection
*
* Copyright Â© 2022 MarceloTLD
* 
* Released under the MIT License
*-----------------------------------------------*/
(function(d,f){typeof exports=="object"&&typeof module<"u"?module.exports=f():typeof define=="function"&&define.amd?define(f):(d=typeof globalThis<"u"?globalThis:d||self,d.bloggerSection=f())})(this,function(){"use strict";function d(e,t){const o=(r,n)=>{e(r,n)};return new IntersectionObserver(o,t||{threshold:.3})}function f(e,t){function o(r,n){if(!Array.isArray(n))return r;const c=/{for(\.\w+)\s+(.+)\s+\/for}/g;let a="";if(c.test(r)){const s=r.match(c)[0].replace(/{for(\.\w+)|\/for}/g,"").trim();n.forEach(l=>{a+=s.replace(/labelName/g,l)})}return r.replace(c,a).trim()}const i=t.replace(/\{\w+\}/g,r=>{let n=r.replace(/{|}/g,"");return e[n]});return o(i,e.label)}function h(e,t){function o(s){return s.match(/post-\d{1,}/g)[0].replace("post-","")}function i(s){let l=s,u="";for(var m=0;m<l.length;m++)l[m].rel=="alternate"&&(u=l[m].href);return u}function r(s){return s.replace(/<[^>]*>?/g,"")}function n(s){const l=r(s);return l.length>t.summaryLength?l.substr(0,t.summaryLength)+"...":l}function c(s){let l=document.createElement("div");l.innerHTML=s;let u=l.querySelector("img");return console.log(u),u?u.getAttribute("src"):t.dftImg||"#noImageFounded"}const a=e.content?e.content.$t:e.summary.$t;return{id:o(e.id.$t),title:e.title?e.title.$t:"No title",thumbnail:e.media$thumbnail?e.media$thumbnail.url.replace(/s\B\d{2,4}(-?w\d{2,4})?-c/,t.resimg?t.resimg:"s200"):c(a),label:e.category?e.category.map(s=>s.term):"",link:i(e.link),url:i(e.link),content:a,summary:n(a),datePost:new Date(e.published.$t).toLocaleDateString(),postUpdate:new Date(e.updated.$t).toLocaleDateString(),datePostIso8601:e.published.$t,authorName:e.name?e.name.$t:"Unknown",authorUri:e.uri?e.uri.$t:"#noProfileUrl"}}function b(e,t,o,i){let r=document.createElement("script"),n=`${e}/feeds/posts/${t?"default/-/"+t:"default"}?alt=json-in-script&max-results=${i}&callback=${o}`;return r.src=n,r}function g(e,t,o,i){return new Promise(r=>{const n=b(e,t,o,i);document.body.appendChild(n),window[o]=a=>{r(a.feed.entry||!1)},n.remove()})}class x{constructor(t,o){this.config=t||{},this.template="",this.custom=o||{},this.mode={},this.init()}#e(){return'<div class="default-card text-left"><picture class="mb-2 block"><a href="{url}" class="block"><img src="{thumbnail}" class="rounded w-full h-36 object-cover"></a></picture><h2 class="text-lg font-bold text-slate-700">{title}</h2><div class="mb-2"><a class="text-xs font-semibold opacity-75" href="{authorUri}">{authorName}</a> - <time class="text-xs font-semibold opacity-75" datetime="{datePostIso8601}">{datePost}</ti></div><p class="text-slate-500 text-sm mb-2">{summary}</p> <div class="flex items-center flex-wrap gap-2 mt-2">{for.label <a href="/search/label/labelName" class="px-2 py-1 bg-slate-100 font-bold text-slate-800 rounded text-xs">labelName</a> /for}</div> <a href="{url}" class="bg-indigo-500 text-white hover:bg-indigo-700 text-xs uppercase duration-150 py-2 px-2 font-semibold rounded inline-block mt-2">More details</a></div>'}setTemplate(t){this.template=t}#t(){return this.template||this.#e()}init(){const t=document.querySelectorAll(".bs-wrapper");if(t.length==0){console.warn("Warning: The node elements is not founded, please check if the node element passing as parameter exist en your HTML document");return}let o=d((i,r)=>{i.forEach(n=>{let c=n.target;if(n.isIntersecting){const a=c.querySelector(".bs-container"),s=c.dataset,l=window.location.protocol+"//"+window.location.hostname;g(s.homeUrl||l,s.label,"bsFn"+(c.index+1),s.results||6).then(u=>{a.innerHTML="",console.log(this.custom),u.forEach(m=>{const p=h(m,this.config);a.innerHTML+=this.custom.customItem?this.custom.customItem.call(this,p,s.style):f(p,this.#t())}),c.removeAttribute("data-bs-cfg"),this.custom.customWrapper&&this.custom.customWrapper.call(this,c,a,s.style||!1,s.mode||!1)}),o.unobserve(c)}})});t.forEach((i,r)=>{i.index=r,o.observe(i)})}}return x});
