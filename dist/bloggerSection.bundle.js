/*!
* blogger.section 0.1.0
* https://github.com/Karasu-themes/bloggerSection
*
* Copyright Â© 2022 MarceloTLD
* 
* Released under the MIT License
*-----------------------------------------------*/
(function(p,g){typeof exports=="object"&&typeof module<"u"?module.exports=g():typeof define=="function"&&define.amd?define(g):(p=typeof globalThis<"u"?globalThis:p||self,p.BloggerSection=g())})(this,function(){"use strict";function p(e,n,r,c){let t=document.createElement("script"),s=`${e}/feeds/posts/${n?"default/-/"+n:"default"}?alt=json-in-script&max-results=${c}&callback=${r}`;return t.src=s,t}function g(e,n,r,c){return new Promise(t=>{const s=p(e,n,r,c);document.body.appendChild(s),window[r]=i=>{t(i.feed.entry||!1)},s.remove()})}function E(e,n){const r=(t,s)=>{e(t,s)};return new IntersectionObserver(r,n||{threshold:.3})}function y(e,n){function r(o){return o.match(/post-\d{1,}/g)[0].replace("post-","")}function c(o){let l=o,a="";for(var m=0;m<l.length;m++)l[m].rel=="alternate"&&(a=l[m].href);return a}function t(o){return o.replace(/<[^>]*>?/g,"")}function s(o){const l=t(o);return l.length>n.summary?l.substr(0,n.summary)+"...":l}function u(o){let l=document.createElement("div");l.innerHTML=o;let a=l.querySelector("img");return console.log(a),a?a.getAttribute("src"):n.dftImage||"#noImageFounded"}const i=e.content?e.content.$t:e.summary.$t;return{id:r(e.id.$t),title:e.title?e.title.$t:"No title",thumbnail:e.media$thumbnail?e.media$thumbnail.url.replace(/s\B\d{2,4}(-?w\d{2,4})?-c/,n.imageParams):u(i),image:e.media$thumbnail?e.media$thumbnail.url:u(i),label:e.category?e.category.map(o=>o.term):"",link:c(e.link),url:c(e.link),content:i,summary:s(i),datePost:new Date(e.published.$t).toLocaleDateString(),postUpdate:new Date(e.updated.$t).toLocaleDateString(),datePostIso8601:e.published.$t,authorName:e.name?e.name.$t:"Unknown",authorUri:e.uri?e.uri.$t:"#noProfileUrl"}}function T(e,n){function r(t,s){if(!Array.isArray(s))return t;const u=/{for(\.\w+)\s+(.+)\s+\/for}/g;let i="";if(u.test(t)){const o=t.match(u)[0].replace(/{for(\.\w+)|\/for}/g,"").trim();s.forEach(l=>{i+=o.replace(/labelName/g,l)})}return t.replace(u,i).trim()}const c=n.replace(/\{(.*?)\}/g,t=>{let s=t.replace(/{|}/g,"");if(/\{image.+\}/.test(t)){const i=t.replace(/{image.|}/g,"");return e.image.replace(/s\B\d{2,4}(-?w\d{2,4})?-c/,i)??""}else return e[s]??""});return r(c,e.label)}function h(e,n){var r;for(r in n)n.hasOwnProperty(r)&&(e[r]=n[r]);return e}function A(e,n){const r=document.querySelectorAll(".bs-wrapper");if(r.length==0){console.warn("Warning: The node elements is not founded, please check if the node element passing as parameter exist en your HTML document");return}let c=E((t,s)=>{t.forEach(u=>{let i=u.target;const o=i.querySelector(".bs-container");if(!o)return;const l=o.querySelector(".bs-render"),a=l.innerHTML.replace("data-",""),m={imageParams:"s300-c-e60-l95",summary:54,results:6};if(u.isIntersecting){const f={...e,...n??{}},d=h({...m,...f},i.dataset??{}),w=window.location.protocol+"//"+window.location.hostname;g(d.homeUrl||w,d.label,"bsFn"+(i.index+1),d.results).then(L=>{let b="";L.forEach($=>{b+=T(y($,h(m,f)),a)}),o.innerHTML=b}),f.modes&&f.modes[d.mode]&&typeof f.modes[d.mode]=="function"&&f.modes[d.mode].call(this,r,o),c.unobserve(i)}})});r.forEach((t,s)=>{t.index=s,c.observe(t)})}var P={start:A};return P});
